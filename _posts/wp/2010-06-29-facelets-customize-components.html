---
layout: post
title: Facelets 自定义组件
categories:
- JSF
tags:
- Facelets
- Tag
published: true
comments: true
---
<p>facelets 可以定义模板,简化页面的编程.采用这个模板的思想,将一些标签组合在一起,就可以做成自定义组件了.将这组合起来的组件定义一个tag标签,然后在 xhtml中引入这个tag,这要比普通的JSP方式的tag方便多了.<br />
要想引用自定义的tag要在web.xml中加入下面代码,当然如果你把该xml文件放到项目根路径或是jar包的根路径下的META-INF文件夹 下,jsf会自动搜索给你加载到jsf容器里.<!--more-->
<div class="cnblogs_code">
<div><span style="color: #008080;"> </span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">context-param</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #000000;"> </span><span style="color: #0000ff;"> &lt;</span><span style="color: #800000;">param-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">facelets.LIBRARIES</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">param-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #008080;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">param-value</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #000000;">/WEB-INF/tld/javachen.taglib.xml
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">param-value</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">context-param</span><span style="color: #0000ff;">&gt;</span></div>
</div>
在该里这样定义:
<div class="cnblogs_code">
<div><span style="color: #008080;"> </span> <span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE facelet-taglib PUBLIC
</span><span style="color: #008080;"> </span> <span style="color: #ff00ff;">"-//Sun Microsystems, Inc.//DTD Facelet Taglib 1.0//EN"
</span><span style="color: #008080;"> </span> <span style="color: #ff00ff;">"http://java.sun.com/dtd/facelet-taglib_1_0.dtd"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">facelet-taglib </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://java.sun.com/JSF/Facelet"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #008080;"> </span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">namespace</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">http://techseed.com/components</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">namespace</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #008080;"> </span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tag</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tag-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">BCNameConverter</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tag-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">converter</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">converter-id</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">BCNameConvert</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">converter-id</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">converter</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tag</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;" /></div></div></p>

<p><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tag</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">tag-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">date</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tag-name</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">source</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">../templates/components/date.xhtml</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">source</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">tag</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">facelet-taglib</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> </span>
<div>该文件中定义先是定义了一个转化器标签,其转化器的id指向另一个配置文件faces-config.xml,在faces-config.xml有如下 定义:</div>

<div class="cnblogs_code">
<div><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">converter</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">converter-id</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">BCNameConvert</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">converter-id</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span> <span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">converter-class</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">com.javachen.converters.BCNameConverter</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">converter-class</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">converter</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> </span></div>
</div>
还定义了一个常规的日期控件标签,其引入了一个xhtml页面:
<div class="cnblogs_code"><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="UTF-8"</span><span style="color: #0000ff;">?&gt;</span><span style="color: #000000;"> </span><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-</span><span style="color: #ff00ff;">transitional.dtd"</span><span style="color: #0000ff;">&gt;</span><span style="color: #0000ff;"> </span>
<div><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ui:composition </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://www.w3.org/1999/xhtml"</span><span style="color: #ff0000;">
</span><span style="color: #008080;"> </span> <span style="color: #ff0000;">xmlns:ui</span><span style="color: #0000ff;">="http://java.sun.com/jsf/facelets"</span><span style="color: #ff0000;">
</span><span style="color: #008080;"> </span> <span style="color: #ff0000;">xmlns:h</span><span style="color: #0000ff;">="http://java.sun.com/jsf/html"</span><span style="color: #ff0000;">
</span> <span style="color: #ff0000;">xmlns:f</span><span style="color: #0000ff;">="http://java.sun.com/jsf/core"</span><span style="color: #ff0000;">
</span><span style="color: #008080;"> </span> <span style="color: #ff0000;">xmlns:a4j</span><span style="color: #0000ff;">="http://richfaces.org/a4j"</span><span style="color: #ff0000;">
</span><span style="color: #ff0000;"> xmlns:rich</span><span style="color: #0000ff;">="http://richfaces.org/rich"</span><span style="color: #ff0000;">
</span><span style="color: #ff0000;"> xmlns:techseed</span><span style="color: #0000ff;">="http://www.techseed.com.cn/jsf"</span><span style="color: #ff0000;">
</span><span style="color: #ff0000;"> xmlns:s</span><span style="color: #0000ff;">="http://jboss.com/products/seam/taglib"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;"> </span><span style="color: #0000ff;"> </span></div>
<div><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h:inputText </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="#{id}"</span><span style="color: #ff0000;"> onfocus</span><span style="color: #0000ff;">="#{oninputfocus}"</span><span style="color: #ff0000;"> </span><span style="color: #ff0000;"> onclick</span><span style="color: #0000ff;">="#{oninputclick}"</span><span style="color: #ff0000;"> size</span><span style="color: #0000ff;">="10"</span><span style="color: #ff0000;"> </span></div>
<div><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="#{value}"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;"> &lt;</span><span style="color: #800000;">techseed:dateTimeConverter </span><span style="color: #ff0000;">pattern</span><span style="color: #0000ff;">="yyyy-MM-dd"</span><span style="color: #ff0000;"> </span><span style="color: #0000ff;">/&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h:inputText</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text/javascript"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #000000;"> bindCalendarDate("#{techseed:clientId(id)}");
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">ui:composition</span><span style="color: #0000ff;">&gt;</span></div>
</div>
只需要注意&lt;ui:composition&gt;标签和引入的命名空间就行，标签里面的内容就看你要完成的功能了。<br />
然后,在页面上调用方式如下:
<div class="cnblogs_code">
<div><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ts:date </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">=""</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">ts:date</span><span style="color: #0000ff;">&gt;</span></div>
</div></p>
